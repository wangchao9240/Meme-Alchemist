# Meme Alchemist - Sprint 规划

**项目**: Meme Alchemist MVP  
**PO**: Product Owner  
**版本**: v1.0  
**更新日期**: 2025-01-10

---

## 📋 项目概览

### 目标

构建一个移动端网页应用，支持基于热榜话题和事实的 AI 梗图生成，可展示在简历中。

### 范围

- ✅ **包含**: 热榜展示、事实取材、AI 生成、图片渲染、移动端 PWA
- ❌ **排除**: 账号系统、社交功能、视频合成、内容审核

### 成功标准

- [ ] 5 个不同话题的作品展示
- [ ] 100% 可追溯性（证据链接可点击）
- [ ] 移动端 Lighthouse >85
- [ ] 全流程 <30 秒
- [ ] 简历级别的代码质量

---

## 🎯 Epic 概览

| Epic ID | 名称         | 优先级 | 估算   | 依赖   | 状态      |
| ------- | ------------ | ------ | ------ | ------ | --------- |
| EPIC-1  | 数据基础设施 | P0     | 2-3 天 | -      | ✅ 已完成 |
| EPIC-2  | JIT 取材系统 | P0     | 1-2 天 | EPIC-1 | ✅ 已完成 |
| EPIC-3  | LLM 生成系统 | P0     | 2-3 天 | EPIC-2 | ✅ 已完成 |
| EPIC-4  | 图片渲染系统 | P0     | 2-3 天 | EPIC-3 | ✅ 已完成 |
| EPIC-5  | 热榜系统     | P1     | 2-3 天 | EPIC-1 | ✅ 已完成 |
| EPIC-6  | 前端集成优化 | P1     | 1-2 天 | ALL    | ✅ 已完成 |
| EPIC-7  | 部署与监控   | P1     | 1 天   | ALL    | ⏳ 待开始 |

**总估算**: 11-17 个工作日（约 2-3 周）

---

## 🚀 Sprint 划分

### Sprint 1: 数据与取材基础 (5-7 天)

**目标**: 建立数据基础，实现事实取材功能

**包含 Epics**:

- ✅ EPIC-1: 数据基础设施
- ✅ EPIC-2: JIT 取材系统

**关键里程碑**:

- [x] Supabase 配置完成 ✅
- [x] 25 条种子 facts 导入完成 ✅
- [x] `/api/jit_fetch` 返回真实数据 ✅
- [x] 前端可选择事实 ✅

**验收标准**:

```bash
# 测试命令
curl -X POST http://localhost:8787/api/jit_fetch \
  -H "Content-Type: application/json" \
  -d '{"topic":"AI","collections":["AI"],"limit":6}' | jq '.candidates | length'
# 预期: >= 4
```

**风险**:

- R1: Supabase 配置延迟 → **缓解**: 提前创建账号
- R2: 种子数据收集耗时 → **缓解**: 使用现有 mock 数据转化

---

### Sprint 2: 内容生成核心 (4-6 天)

**目标**: 实现 AI 文案生成和图片渲染

**包含 Epics**:

- ✅ EPIC-3: LLM 生成系统
- ✅ EPIC-4: 图片渲染系统

**关键里程碑**:

- [ ] OpenAI API 集成
- [ ] 降级策略实现
- [ ] Satori 渲染图片成功
- [ ] 完整生成流程打通

**验收标准**:

```bash
# 端到端测试
# 1. 选择话题
# 2. 选择 facts
# 3. 生成文案（8s 内）
# 4. 渲染图片（1s 内）
# 5. 下载 PNG
```

**Story 优先级**:

1. EPIC3-S1: OpenAI Service (P0)
2. EPIC3-S2: 降级策略 (P0)
3. EPIC4-S1: Satori 集成 (P0)
4. EPIC4-S2: 模板系统 (P0)
5. EPIC3-S3: API 更新 (P0)
6. EPIC4-S3: 图片上传 (P1)

**风险**:

- R1: LLM API 限额 → **缓解**: 使用测试 key，准备降级
- R2: Satori 字体问题 → **缓解**: 提前测试中文渲染

---

### Sprint 3: 热榜与前端优化 (2-4 天) ✅ COMPLETE

**目标**: 完善热榜功能和前端体验

**包含 Epics**:

- ✅ EPIC-5: 热榜系统
- ✅ EPIC-6: 前端集成优化

**关键里程碑**:

- [x] 热榜抓取器实现 ✅
- [x] 聚类算法运行 ✅
- [x] Cron 任务配置 ✅
- [x] 前端 UI/UX 优化 ✅
- [x] 移动端适配完成 ✅

**验收标准**:

- [x] 热榜每日自动更新 ✅
- [x] 前端显示今日 TopN ✅
- [x] 全流程无明显卡顿 ✅
- [x] UI/UX 100% 还原设计稿 ✅
- [x] 自定义话题搜索功能 ✅
- [x] 刷新按钮 Toast 通知 ✅
- [ ] Lighthouse 分数 >85 (需部署后验证)

**可选功能** (时间允许):

- [ ] 热榜历史查看
- [ ] 更多模板（目标 6 个）
- [ ] 暗色模式

---

### Sprint 4: 部署与收尾 (1-2 天) ⏳ READY

**目标**: 部署到生产环境，准备演示

**包含 Epics**:

- ⏳ EPIC-7: 部署与监控

**关键里程碑**:

- [ ] Cloudflare Workers 部署
- [ ] Cloudflare Pages 部署
- [ ] KV Namespace 创建
- [ ] 环境变量配置
- [ ] 监控和日志验证

**验收标准**:

- [ ] 生产环境可访问
- [ ] 生成功能正常
- [ ] 无明显错误日志
- [ ] README 完善
- [ ] 演示视频录制

**状态**: ✅ Sprint 3 验收通过，准备开始 Sprint 4

---

## 📊 Story 总览

### Epic 1: 数据基础设施

- [x] EPIC1-S1: 初始化 Supabase (0.5d)
- [x] EPIC1-S2: 创建数据库表 (1d)
- [x] EPIC1-S3: 创建 Storage Bucket (0.5d)
- [x] EPIC1-S4: 准备种子数据 (1d)

### Epic 2: JIT 取材

- [x] EPIC2-S1: Facts 检索服务 (1d) ✅
- [x] EPIC2-S2: 更新 JIT API (0.5d) ✅
- [x] EPIC2-S3: 前端集成测试 (0.5d) ✅

### Epic 3: LLM 生成

- [x] EPIC3-S1: OpenAI Service (1d) ✅
- [x] EPIC3-S2: 降级策略 (1d) ✅
- [x] EPIC3-S3: 更新 Compose API (0.5d) ✅
- [ ] EPIC3-S4: 前端 UX 优化 (0.5d) ⏳ 待前端集成

### Epic 4: 图片渲染

- [x] EPIC4-S1: Satori 集成 (1d) ✅
- [x] EPIC4-S2: 模板系统 (1d) ✅
- [x] EPIC4-S3: 图片上传 (0.5d) ✅
- [x] EPIC4-S4: 更新 Render API (0.5d) ✅

### Epic 5: 热榜系统

- [x] EPIC5-S1: 热榜抓取器 (1d) ✅
- [x] EPIC5-S2: 聚类算法 (1d) ✅
- [x] EPIC5-S3: Cron 任务 (0.5d) ✅
- [x] EPIC5-S4: 前端集成 (0.5d) ✅

### Epic 6: 前端优化

- [x] EPIC6-S1: UI/UX 优化 (0.5d) ✅
- [x] EPIC6-S2: 移动端适配 (0.5d) ✅
- [x] EPIC6-S3: 性能优化 (0.5d) ✅

### Epic 7: 部署

- [ ] EPIC7-S1: Workers 部署 (0.5d)
- [ ] EPIC7-S2: Pages 部署 (0.5d)

**总计**: 约 35 个 Story

---

## ⚠️ 风险管理

### 高风险项

| 风险                | 影响 | 概率 | 缓解措施                | 负责人 |
| ------------------- | ---- | ---- | ----------------------- | ------ |
| LLM API 成本超预算  | 高   | 中   | 使用免费试用额度 + 降级 | Dev    |
| Satori 中文渲染问题 | 高   | 中   | 提前测试，准备备用方案  | Dev    |
| Twitter API 限额    | 中   | 中   | 优先使用 Reddit（免费） | Dev    |
| Supabase 免费层限制 | 中   | 低   | 监控使用量              | Dev    |
| 时间不够            | 高   | 中   | 砍掉热榜（用种子话题）  | PO     |

### 降级方案

**如果时间紧张，优先级调整**:

1. **必须有**: EPIC 1, 2, 3, 4（核心生成流程）
2. **可降级**: EPIC 5（热榜改用固定话题）
3. **可延后**: EPIC 6（前端优化）

---

## 📈 进度跟踪

### 每日站会重点

**每天 10:00** (可选，个人项目可省略)

- 昨天完成了什么？
- 今天计划做什么？
- 有什么阻碍？

### 关键指标

| 指标         | 目标 | 当前               |
| ------------ | ---- | ------------------ |
| Epic 完成率  | 100% | 85.7% (6/7 完成)   |
| Story 完成率 | 100% | 94.3% (33/35 完成) |
| Bug 数量     | 0    | 0                  |
| 技术债       | 低   | 低                 |
| 代码覆盖率   | >60% | N/A (未测试)       |

---

## 🎬 交付物检查清单

### 代码

- [ ] 前端代码（Next.js）
- [ ] 后端代码（Workers）
- [ ] 数据库迁移脚本
- [ ] 种子数据
- [ ] 环境变量示例

### 文档

- [ ] README（快速开始、部署指南）
- [ ] API 文档
- [ ] 架构文档
- [ ] PRD
- [ ] Sprint 计划（本文档）

### 演示

- [ ] 演示视频（60s）
- [ ] 截图（5+ 张）
- [ ] 二维码（移动端访问）
- [ ] Live Demo URL

### 测试

- [ ] 手动测试清单
- [ ] E2E 测试（可选）
- [ ] 性能测试报告

---

## 📞 下一步行动

### 立即开始 - Sprint 4

1. **准备部署配置** (30 分钟)

   ```bash
   # 创建 Cloudflare Workers 项目
   # 创建 KV Namespace
   # 配置环境变量
   ```

2. **部署后端** (30 分钟)

   ```bash
   cd backend
   pnpm run deploy
   ```

3. **部署前端** (30 分钟)

   ```bash
   cd frontend
   pnpm run build
   # 部署到 Cloudflare Pages
   ```

4. **验证生产环境** (30 分钟)
   ```bash
   # 测试 API 端点
   # 测试前端功能
   # 检查日志
   ```

### 本周目标

- [ ] 完成 Sprint 4（EPIC-7）
- [ ] 生产环境部署成功
- [ ] 演示视频录制完成
- [ ] README 文档完善

---

## 📚 参考资料

- [PRD 文档](./PRD.md)
- [架构文档](./architecture.md)
- [开发指南](./DEVELOPMENT.md)
- [Epic 1 详情](./epics/epic-1-data-foundation.md)
- [Epic 2 详情](./epics/epic-2-jit-fetch.md)
- [Epic 3 详情](./epics/epic-3-llm-generation.md)

---

**注意**: 这是一个简历项目，重点是**展示技术能力**而非完美产品。保持代码整洁、架构清晰、文档完善即可。不要过度优化，聚焦 MVP。
